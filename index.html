<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Deformable Neural Radiance Fields creates free-viewpoint portraits (nerfies) from casually captured videos.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Control-Oriented Clustering of Visual Latent Representation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z2ETZM1K52"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Z2ETZM1K52');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="https://seas.harvard.edu/themes/custom/seas/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Control-Oriented Clustering of <br> Visual Latent Representation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://han20192019.github.io/">Han Qi</a><sup>*1</sup>,
            </span>
            <span class="author-block">
              <a href="https://haochengyin.github.io/">Haocheng Yin</a><sup>*2</sup>,
            </span>
            <span class="author-block">
              <a href="https://hankyang.seas.harvard.edu/">Heng Yang</a><sup>1</sup>,
            </span>

          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>*</sup>Equal contribution,</span>
            <span class="author-block"><sup>1</sup>Harvard University,</span>
            <span class="author-block"><sup>2</sup>ETH Zurich</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <!-- https://arxiv.org/pdf/2011.12948 -->
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <!-- https://arxiv.org/abs/2011.12948 -->
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <!-- https://github.com/google/nerfies -->
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming soon)</span>
                </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                </a>
              </span>  
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Overview. -->
<div class="content is-centered is-full-width has-text-centered">
  <iframe src="./static/images/nc-overview.pdf#toolbar=0" width="900" height="178"></iframe>
</div>
<!-- Overview. -->

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We initiate a study of the geometry of the visual representation space --the information 
            channel from the vision encoder to the action decoder-- in an image-based control pipeline 
            learned from behavior cloning. Inspired by the phenomenon of <em>neural collapse</em> (NC) in 
            image classification <a href="https://arxiv.org/abs/2008.08186">(Papyan et al., 2020)</a>, we 
            investigate whether a similar <em>law of clustering</em> emerges in the visual representation space. 
            Since image-based control is a regression task without explicitly defined classes, the central piece 
            of the puzzle lies in determining according to what <em>implicit classes</em> the visual features 
            cluster, if such a law exists.
          </p>
          <p>
            Focusing on image-based <em>planar pushing</em>, we posit the most important role of the visual 
            representation in a control task is to <em>convey a goal</em> to the action decoder; for instance, 
            <q>rotate the object clockwise and push it northeast</q>. We then classify training samples of expert 
            demonstrations into eight <q><em>control-oriented </em></q> classes --based on (a) the relative pose 
            between the object and the target in the input or (b) the relative pose of the object induced by expert 
            actions in the output-- where one class corresponds to one <em>relative pose orthant</em> 
            (<span class="dnerf">Repo</span>s). Across four different instantiations of the vision-based control 
            architecture, we report the prevalent emergence of control-oriented clustering (similar to NC) in the 
            visual representation space according to the eight <span class="dnerf">Repo</span>s. 
          </p>
          <p>
            Beyond empirical observation, we show such a law of clustering can be leveraged as an 
            <em>algorithmic tool</em> to improve test-time performance when training a policy with a limited 
            amount of expert demonstrations. Particularly, we <em>pretrain</em> the vision encoder using NC as a 
            <em>regularization</em> to encourage control-oriented clustering of the visual features. Surprisingly, 
            such an NC-pretrained vision encoder, when finetuned end-to-end with the action decoder, boosts the 
            test-time performance by 10% to 35% in the low-data regime. Real-world vision-based planar 
            pushing experiments confirmed the surprising advantage of control-oriented visual representation 
            pretraining.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- NC Phenomenon. -->
    <h2 class="title is-3">NC Phenomenon</h2>
    
    <!-- Simulated Eval. -->
    <h3 class="title is-4">Evaluation on Simulation</h3>
    <div class="content has-text-justified">
      <p>
        Write some description here.
      </p>
    </div>
    <div class="columns is-centered">
      <div class="column is-full-width">
          <div class="content is-4 has-text-centered">
            <img src="static/images/sim_domain_18_seed_81.webp" width="70%" alt="sim_sample_video">
            <p>Evaluation Video</p>
          </div>
        <!--/ Simulated Eval. -->
      </div>

      <div class="column is-full-width">
        <div class="content is-4 has-text-centered">
          <iframe src="./static/images/sim_domain18_resnet_diffusion_nc1_input_space.pdf#toolbar=0" width="70%" height="100%"></iframe>
          <p>Evaluation Score</p>
        </div>
      </div>
    </div>

    <!-- NC Performance Metrics. -->
    <h3 class="title is-4">NC Performance Metrics</h3>
    <div class="content has-text-justified">
      <p>
        Write some text here.
      </p>
    </div>
    <div class="columns is-centered">
      <div class="column is-full-width">
        <div class="content is-3 has-text-centered">
          <iframe src="./static/images/sim_domain18_resnet_diffusion_nc1_input_space.pdf#toolbar=0" height="100%" ></iframe>
          <p>Class-Distance Normalized Variance</p>
        </div>
      </div>
      
      <div class="column">
        <div class="content is-3 has-text-centered">
          <iframe src="./static/images/sim_domain18_resnet_diffusion_nc2angle_input_space.pdf#toolbar=0" height="100%"></iframe>
          <p>Standard Deviation of Angle Spanned by Cluster Mean Vectors</p>
        </div>
      </div>

      <div class="column">
        <div class="content is-3 has-text-centered">
          <iframe src="./static/images/sim_domain18_resnet_diffusion_nc2norm_input_space.pdf#toolbar=0" height="100%"></iframe>
          <p>Standard Deviation of Length of Cluster Mean Vectors</p>
        </div>
      </div>
    </div>
    <!--/ NC Performance Metrics. -->

    <!--/ NC Phenomenon.. -->


    <!-- Real-World Validation. -->
    <div class="columns is-centered">
      <div class="column">
        <h2 class="title is-3">Real-World Validation</h2>
        <div class="content is-centered has-text-centered">
          <img src="./static/images/real_100demos_nc_encouraged_eval_demo_8_traj.png" height="100%" alt="real_sample_nc_encouraged_traj">
          <p>Real-world evaluation trajectory of test 8 for <b>NC-pretrained</b> policy trainined under 100 demos</p>
        </div>
        <div class="content is-centered has-text-centered">
          <img src="./static/images/real_100demos_baseline_eval_demo_8_traj.png" height="100%" alt="real_sample_baseline_traj">
          <p>Real-world evaluation trajectory of test 8 for <b>baseline</b> policy trainined under 100 demos</p>
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <video id="sample1" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/real_eval_demo_8_NC_encouraged_video.mp4"
                    type="video/mp4">
          </video>
          <p>
            Real-world evaluation video of test 8 for <b>NC-pretrained</b> policy trainined under 100 demos
          </p>
        </div>
      </div>

      <div class="column">
        <div class="content">
          <video id="sample2" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/real_eval_demo_8_baseline_video.mp4"
                    type="video/mp4">
          </video>
          <p>
            Real-world evaluation video of test 8 for <b>baseline</b> policy trainined under 100 demos
          </p>
        </div>
      </div>

    </div>
    <!--/ Real-World Validation. -->

  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>
      <!-- @article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
} -->
</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="">
         <!-- ./static/videos/nerfies_paper.pdf -->
        <i class="fas fa-file-pdf"></i>
      </a>
      <!-- https://github.com/keunhong -->
      <a class="icon-link" href="" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
